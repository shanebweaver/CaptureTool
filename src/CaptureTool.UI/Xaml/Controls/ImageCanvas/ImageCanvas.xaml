<?xml version="1.0" encoding="utf-8" ?>
<UserControl
    x:Class="CaptureTool.UI.Xaml.Controls.ImageCanvas.ImageCanvas"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:canvasui="using:Microsoft.Graphics.Canvas.UI.Xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:CaptureTool.UI.Xaml.Controls.ImageCanvas"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Background="{ThemeResource LayerOnMicaBaseAltFillColorDefault}"
    mc:Ignorable="d">
    <Grid
        x:Name="CanvasContainer"
        PointerCanceled="CanvasContainer_PointerCanceled"
        PointerCaptureLost="CanvasContainer_PointerCaptureLost"
        PointerMoved="CanvasContainer_PointerMoved"
        PointerPressed="CanvasContainer_PointerPressed"
        PointerReleased="CanvasContainer_PointerReleased"
        SizeChanged="CanvasContainer_SizeChanged">
        <ScrollView
            x:Name="CanvasScrollView"
            HorizontalScrollBarVisibility="Auto"
            ZoomMode="Enabled">
            <Grid
                x:Name="DrawingCanvasPanel"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">

                <canvasui:CanvasControl
                    x:Name="DrawingCanvas"
                    CreateResources="CanvasControl_CreateResources"
                    Draw="CanvasControl_Draw" />

                <Grid
                    x:Name="CropBoundary"
                    PointerMoved="CropBoundary_PointerMoved"
                    PointerPressed="CropBoundary_PointerPressed"
                    PointerReleased="CropBoundary_PointerReleased">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Dashed border  -->
                    <Rectangle
                        Grid.RowSpan="5"
                        Grid.ColumnSpan="5"
                        Margin="-3"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        Stroke="White"
                        StrokeDashArray="4,4"
                        StrokeThickness="2"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}" />

                    <!--  Crop anchors  -->
                    <!--  Top left  -->
                    <Polygon
                        Fill="White"
                        Points="0,0 20,0 20,4, 4,4 4,20, 0,20"
                        Stroke="Black"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}">
                        <Polygon.RenderTransform>
                            <TranslateTransform X="-4" Y="-4" />
                        </Polygon.RenderTransform>
                    </Polygon>
                    <!--  Top  -->
                    <Polygon
                        Grid.Column="2"
                        Fill="White"
                        Points="0,0 20,0 20,4 0,4"
                        Stroke="Black"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}">
                        <Polygon.RenderTransform>
                            <TranslateTransform Y="-4" />
                        </Polygon.RenderTransform>
                    </Polygon>
                    <!--  Top right  -->
                    <Polygon
                        Grid.Column="4"
                        Fill="White"
                        Points="0,0 20,0 20,20 16,20 16,4 0,4"
                        Stroke="Black"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}">
                        <Polygon.RenderTransform>
                            <TranslateTransform X="5" Y="-4" />
                        </Polygon.RenderTransform>
                    </Polygon>
                    <!--  Left  -->
                    <Polygon
                        Grid.Row="2"
                        Fill="White"
                        Points="0,0 4,0 4,20 0,20"
                        Stroke="Black"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}">
                        <Polygon.RenderTransform>
                            <TranslateTransform X="-4" />
                        </Polygon.RenderTransform>
                    </Polygon>
                    <!--  Right  -->
                    <Polygon
                        Grid.Row="2"
                        Grid.Column="4"
                        Fill="White"
                        Points="16,0 20,0 20,20 16,20"
                        Stroke="Black"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}">
                        <Polygon.RenderTransform>
                            <TranslateTransform X="5" />
                        </Polygon.RenderTransform>
                    </Polygon>
                    <!--  Bottom left  -->
                    <Polygon
                        Grid.Row="4"
                        Fill="White"
                        Points="0,0 4,0 4,16 20,16 20,20 0,20"
                        Stroke="Black"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}">
                        <Polygon.RenderTransform>
                            <TranslateTransform X="-5" Y="6" />
                        </Polygon.RenderTransform>
                    </Polygon>
                    <!--  Bottom  -->
                    <Polygon
                        Grid.Row="4"
                        Grid.Column="2"
                        Fill="White"
                        Points="0,16 20,16 20,20 0,20"
                        Stroke="Black"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}">
                        <Polygon.RenderTransform>
                            <TranslateTransform Y="6" />
                        </Polygon.RenderTransform>
                    </Polygon>
                    <!--  Bottom right  -->
                    <Polygon
                        Grid.Row="4"
                        Grid.Column="4"
                        Fill="White"
                        Points="16,0 20,0 20,20 0,20 0,16 16,16"
                        Stroke="Black"
                        Visibility="{x:Bind IsCropModeEnabled, Mode=OneWay}">
                        <Polygon.RenderTransform>
                            <TranslateTransform X="6" Y="6" />
                        </Polygon.RenderTransform>
                    </Polygon>
                </Grid>
            </Grid>
        </ScrollView>
    </Grid>
</UserControl>
